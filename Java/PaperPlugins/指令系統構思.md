# 指令系統規劃

- 製作人 [name=灰毛]
- 協作人 [name=Xakoverse] [name=Shirako]
- 規劃起始時間：[time=6/29 00:00]
- 最後更新時間：[time=6/29 02:51]
[color=gray] NothingBase &nbsp;&nbsp;[color=gray] Minecraft伺服器 &nbsp;&nbsp;[color=gray] 憑空出現

---
系統結構：

| 已規劃 | 已實作 | 功能&系統名稱                  |
| ------ | ------ | -------------------------- |
| X      | X      | 核心系統（整合API用）         |
| X      | X      | 側邊欄&TAB系統              |
| V      | X      | 金錢系統                    |
| V      | X      | 家園系統                    |
| X      | X      | 新手系統                    |
| X      | X      | 商店系統                    |
| V      | X      | 領地系統                    |
| V      | X      | 傳送系統                    |
| V      | X      | 陣營系統                    |
| X      | X      | 委託系統                    |
| X      | X      | 專武系統                    |
| X      | X      | 自定義物品系統               |
| X      | X      | 好友系統                    |

核心系統：
```
Interface
Utils：utilities
```
金錢系統：

```json
Aliases: /money, /eco
/money pay <玩家> <金錢> -- 玩家付款給對方
/money ask <玩家> <金錢> -- 向對方發送付款請求
/money set <玩家> <金錢> -- 設定玩家金錢數量
/money take <玩家> <金錢> -- 移除玩家特定金額
/money give <玩家> <金錢> -- 給予玩家特定金額
/money clear <玩家> -- 清除玩家所有金錢

金錢系統詳細規劃：
```
經濟機制與交易流程：
- 玩家間付款：即時轉帳，支援金額驗證
- 付款請求：發送方請求，接收方確認，1分鐘後自動取消
- 交易記錄：所有金錢變動都記錄時間、對象、金額、原因
- 餘額查詢：玩家可隨時查看自己的金錢餘額和近期交易

管理員經濟控制：
- 金錢設定：直接設定玩家的金錢數量
- 金錢增減：給予或扣除特定玩家的金額
- 帳戶清空：重置玩家金錢為0
- 交易監控：查看玩家的交易歷史和異常交易

安全防護機制：
- 負數保護：禁止金錢變為負數，不足時交易失败
- 上限保護：防止金錢數值溢位，設定合理上限
- 重複交易：防止重複點擊造成的多次交易
- 作弊檢測：監控異常的金錢增長和交易模式

系統整合功能：
- 商店系統：提供購買物品的金錢扣除
- 委託系統：提供任務獎勵的金錢發放
- 家園系統：支援家園設定的金錢消耗（可選）
- 陣營系統：支援陣營資金池和共同開支

資料庫設計：
- 玩家金錢表：玩家ID、當前金額、最後更新時間
- 交易記錄表：交易ID、付款方、收款方、金額、交易時間、交易類型
- 系統操作表：管理員ID、操作類型、目標玩家、金額變動、操作時間
```

家園系統：

```json
Aliases: no aliases
/home -- 傳送至快速傳送點或第一個家園
/home set [家園名稱] -- 設定當前地點為家園
/home tp <家園名稱> -- 傳送至特定家園
/home setfasttp [家園名稱] -- 設定快速傳送點
/home list --

家園系統詳細規劃：
```
家園管理機制：
- 家園設定：玩家可在任意位置設定家園點
- 家園命名：支援自定義家園名稱，便於區分用途
- 家園覆蓋：新設定的家園會覆蓋同名的舊家園
- 家園列表：顯示所有家園的名稱、座標和設定時間

快速傳送系統：
- 快速傳送點：設定一個主要的家園作為快速傳送目標
- 無參數傳送：使用 /home 直接傳送到快速傳送點
- 預設邏輯：若無快速傳送點，則傳送到第一個設定的家園
- 傳送確認：傳送前顯示目標位置資訊

家園數量限制：
- 基礎限制：每位玩家預設最多3個家園（可配置）
- 權限擴展：VIP玩家可設定更多家園點
- 超限處理：達到上限時需要先刪除舊家園才能設定新家園
- 限制提醒：嘗試超限時給予明確的提示訊息

安全與驗證：
- 位置驗證：檢查設定位置是否安全（非虛空、非熔岩等）
- 領地檢查：確認玩家有權在該位置設定家園
- 世界限制：可配置禁止在特定世界設定家園
- 冷卻時間：設定家園後的冷卻時間防止濫用

系統整合功能：
- 傳送系統：共用傳送邏輯和安全檢查
- 領地系統：檢查家園位置是否在允許區域
- 陣營系統：支援陣營共同家園（可選功能）
- 金錢系統：可設定家園設定需要消耗金錢（可選）

資料庫設計：
- 家園資料表：玩家ID、家園名稱、世界名稱、X座標、Y座標、Z座標、朝向、設定時間
- 快速傳送表：玩家ID、快速傳送家園名稱
- 家園配置表：最大家園數量、冷卻時間、消耗金錢、禁用世界列表
```

傳送系統：

```json
Aliases: no aliases
/to random, /rto -- 隨機傳送到無人區
/to <玩家> -- 請求傳送至特定玩家
/toac -- 同意玩家傳送請求
/todn -- 拒絕玩家傳送請求
/to public tp <傳送點> -- 傳送至公共傳送點
/to public set <公共傳送點> -- 設定公共傳送點
/to public remove <公共傳送點> -- 移除公共傳送點

傳送系統詳細規劃：
```
玩家間傳送機制：
- 傳送請求：玩家向目標玩家發送傳送請求
- 請求處理：目標玩家可選擇同意或拒絕請求
- 超時機制：請求30秒後自動取消，且5分鐘後不得重新請求（除非好友），避免騷擾
- 狀態提醒：即時通知雙方請求狀態變化

隨機傳送系統：
- 無人區傳送：傳送到距離其他玩家較遠的安全區域
- 安全檢查：確保傳送位置不在危險環境（熔岩、虛空等）
- 範圍限制：在指定的世界邊界內隨機選擇位置
- 重試機制：如果位置不安全，自動重新選擇位置

公共傳送點管理：
- 傳送點設定：管理員可設定公共傳送點
- 傳送點分類：spawn（出生點）、shop（商店）、pvp（競技場）等
- 傳送點資訊：顯示傳送點名稱、描述和設定者
- 傳送點移除：管理員可移除不需要的傳送點

傳送安全機制：
- 冷卻時間：傳送後需等待一段時間才能再次傳送
- 移動取消：傳送過程中移動會取消傳送
- 戰鬥保護：戰鬥狀態中無法使用傳送功能
- 位置驗證：確保傳送目標位置安全且可到達

權限與限制：
- 傳送權限：不同權限組有不同的傳送冷卻時間
- 世界限制：某些世界可能禁止傳送進入或傳送離開
- 距離限制：可設定同世界傳送的最大距離限制
- 次數限制：每日傳送次數限制（可配置）

系統整合功能：
- 家園系統：整合家園傳送邏輯和安全檢查
- 陣營系統：支援陣營據點傳送
- 領地系統：檢查傳送目標是否允許傳送進入
- 金錢系統：可設定傳送需要消耗金錢（可選）

資料庫設計：
- 公共傳送點表：傳送點名稱、世界名稱、座標、描述、設定者、設定時間
- 傳送記錄表：玩家ID、傳送類型、起點座標、終點座標、傳送時間
- 冷卻狀態表：玩家ID、上次傳送時間、冷卻結束時間
- 傳送配置表：冷卻時間設定、權限組設定、世界限制、每日次數限制
```

陣營系統：

```json
Aliases: /side, /group
/side join <陣營> -- 加入特定陣營
/side leave <陣營> -- 離開陣營
/side add <陣營> <顏色> -- 創建陣營
/side remove <陣營> -- 移除陣營
/side admin <陣營> add <玩家> -- 設定陣營管理員
/side admin <陣營> remove <玩家> -- 移除陣營管理員
/side res hook <領地名稱> [main|sub] -- 將領地與陣營掛勾
/side res unhook <領地名稱> -- 取消領地與陣營掛勾
/side res list -- 列出陣營掛勾的領地
/side spawn set <領地名稱> -- 設定陣營出生點
/side spawn tp -- 傳送至陣營出生點
/side home -- 快速傳送至陣營主領地

陣營系統詳細規劃：
```
陣營組織架構：
- 陣營創建：設定陣營名稱和代表顏色
- 陣營解散：leader可解散陣營，需要確認步驟
- 陣營資訊：顯示成員數量、創建時間、活躍度
- 陣營列表：查看伺服器內所有陣營的基本資訊

職階權限體系：
- Leader（領袖）：最高權限，可執行所有陣營操作
- Operator（管理）：協助管理，可邀請/踢除成員，設定權限
- Member（成員）：基本成員，可使用陣營功能
- Guest（賓客）：臨時身份，權限受限

成員管理機制：
- 邀請系統：管理員可邀請新成員加入陣營
- 申請系統：玩家可申請加入公開的陣營
- 踢除功能：管理員可踢除違規或不活躍成員
- 職階調整：leader可調整成員的職階

離隊與重新加入：
- 離隊準備期：申請離隊後3天準備期，可取消
- 保護期：離隊後7天內不能加入新陣營
- 重新加入限制：離隊後10天內不能重新加入原陣營
- 強制踢除：被踢除者有15天的重新加入限制

領地掛鉤系統：
- 主領地掛鉤：陣營的核心據點，設定出生點
- 副領地掛鉤：陣營的擴展區域，用於資源和特殊用途
- 掛鉤效果：陣營成員自動獲得領地權限
- 掛鉤解除：解除後成員權限自動移除

陣營據點功能：
- 出生點設定：在掛鉤領地中設定陣營出生點
- 快速傳送：成員可快速傳送到陣營據點
- 據點保護：陣營據點享有特殊保護機制
- 資源共享：陣營成員可共享據點資源

自動管理邏輯：
1. 加入陣營時：自動加入所有掛鉤領地，獲得相應權限
2. 職階變更時：自動更新在所有掛鉤領地中的權限
3. 離開陣營時：自動從所有掛鉤領地中移除
4. 領地掛鉤時：自動將所有陣營成員加入該領地
5. 解除掛鉤時：自動將所有陣營成員從該領地移除

陣營活動系統：
- 活躍度追蹤：記錄成員的線上時間和貢獻
- 陣營任務：集體完成的任務和挑戰
- 陣營等級：根據活躍度和成就提升陣營等級
- 獎勵機制：活躍的陣營獲得特殊獎勵

系統整合功能：
- 領地系統：深度整合，自動權限同步和管理
- 傳送系統：支援陣營據點傳送
- 金錢系統：支援陣營資金池和共同開支
- 家園系統：可設定陣營共同家園

資料庫設計：
- 陣營資料表：陣營ID、陣營名稱、代表顏色、創建者、創建時間、狀態
- 成員資料表：陣營ID、玩家ID、職階、加入時間、活躍度、狀態
- 領地掛鉤表：陣營ID、領地名稱、掛鉤類型（main/sub）、掛鉤時間
- 離隊記錄表：玩家ID、陣營ID、離隊時間、離隊類型、限制到期時間
- 陣營配置表：職階權限設定、離隊機制參數、活躍度計算規則
```

領地系統：

```json
Aliases: /res, /residence
/res create <領地名稱> -- 創建領地
/res select -- 開啟領地選擇模式
/res info [領地名稱] -- 查看領地資訊
/res list [玩家名稱] -- 列出領地
/res tp <領地名稱> -- 傳送至領地
/res set <領地名稱> <權限> <true|false> -- 設定領地權限
/res pset <領地名稱> <玩家> <權限> <true|false> -- 設定玩家權限
/res gset <領地名稱> <群組> <權限> <true|false> -- 設定群組權限
/res remove <領地名稱> -- 刪除領地
/res rename <舊領地名稱> <新領地名稱> -- 重新命名領地
/res message <領地名稱> enter <訊息> -- 設定進入訊息
/res message <領地名稱> leave <訊息> -- 設定離開訊息
/res padd <領地名稱> <玩家> -- 加入領地成員
/res pdel <領地名稱> <玩家> -- 移除領地成員
/res subzone <子領地名稱> <父領地名稱> -- 創建子領地
/res subzone info <子領地名稱> -- 查看子領地資訊
/res subzone list <父領地名稱> -- 列出子領地
/res subzone remove <子領地名稱> -- 刪除子領地
/res subzone expand <子領地名稱> <方向> <格數> -- 擴展子領地
/res subzone contract <子領地名稱> <方向> <格數> -- 縮小子領地
/res subzone set <子領地名稱> <權限> <true|false> -- 設定子領地權限
/res subzone pset <子領地名稱> <玩家> <權限> <true|false> -- 設定子領地玩家權限
/res subzone padd <子領地名稱> <玩家> -- 加入子領地成員
/res subzone pdel <子領地名稱> <玩家> -- 移除子領地成員
/res subzone tp <子領地名稱> -- 傳送至子領地
/res subzone rename <舊子領地名稱> <新子領地名稱> -- 重新命名子領地
/res side info <領地名稱> -- 查看陣營掛鉤狀態
/res side rank <領地名稱> <職階> <權限> <true|false> -- 設定職階權限
/res side permission <領地名稱> <陣營權限> <true|false> -- 設定陣營權限
/res subzone side template <子領地名稱> <功能類型> -- 套用功能區域模板
/res subzone side assign <子領地名稱> <陣營成員> <管理等級> -- 指派子領地管理者
/res admin create <領地名稱> <玩家> -- 管理員創建領地
/res admin remove <領地名稱> -- 管理員刪除領地
/res admin tp <領地名稱> -- 管理員傳送至領地
/res admin give <玩家> <領地名稱> -- 轉移領地所有權
/res admin set <領地名稱> <權限> <true|false> -- 管理員設定權限
/res admin expand <領地名稱> <方向> <格數> -- 管理員擴展領地
/res admin contract <領地名稱> <方向> <格數> -- 管理員縮小領地
```
領地系統詳細規劃：
```
權限層級架構（由高到低）：
1. 伺服器管理員 - 最高權限，可管理所有領地與陣營
2. 陣營管理員 - 管理陣營掛鉤的領地關係
3. 領地所有者 - 管理個人領地與子領地權限
4. 子領地管理者 - 管理指定的子領地
5. 陣營成員 - 根據職階享有不同權限
6. 領地成員 - 基本的領地使用權限
7. 訪客 - 最低權限

功能區域類型與預設權限：
- spawn（出生點）：允許傳送、禁止建造、禁止PvP
- storage（倉庫區）：允許容器使用、限制建造、成員專用
- farm（農場區）：允許農作、允許建造、禁止破壞
- pvp（競技場）：允許PvP、禁止建造、公開進入
- safe（安全區）：禁止PvP、禁止破壞、公開進入
- trade（交易區）：允許交易、禁止建造、公開進入

陣營領地自動管理邏輯：
1. 當玩家使用 /side join <陣營> 加入陣營時，系統自動檢查該陣營所有掛鉤的領地
2. 如果玩家尚未加入某個陣營領地，系統會自動將玩家加入該領地成員列表
3. 玩家將根據其陣營職階自動獲得相應的領地權限
4. 當玩家在陣營中的職階發生變更時，系統會自動更新其在所有陣營領地中的權限
5. 當玩家離開陣營時，系統會自動將其從所有陣營領地中移除
6. 自動管理僅適用於陣營掛鉤的領地，不影響個人領地

權限繼承與覆蓋規則：
1. 子領地繼承父領地的基本權限
2. 子領地的特定設定會覆蓋父領地權限
3. 陣營權限與個人領地權限分別管理，互不影響
4. 管理員權限可覆蓋所有其他權限

陣營領地整合邏輯：
1. 主領地作為陣營的核心據點，設定陣營出生點
2. 副領地作為陣營的擴展區域，可用於資源收集或特殊用途
3. 子領地根據功能劃分，提供專門的服務區域
4. 職階系統決定成員在不同區域的權限範圍
5. 所有詳細權限設定都在 /res 系統中完成
```
